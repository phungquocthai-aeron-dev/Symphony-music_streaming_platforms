<style>
  .hashtag_category:hover {
    background-color: var(--orange-color) !important;
    color: var(--black-color) !important;
    font-weight: 600;
  }
</style>
<main id="content" class="container-fluid bg-black-primary">
  <div class="row">
    <div class="col-2 bg-black-primary"></div>
    <div class="col-10 content p-4 pt-0">
      <!-- ALERT -->
      <div
        *ngIf="notifyTitle !== ''"
        class="alert alert-dismissible fade show"
        role="alert"
        id="fixedAlert"
        [ngClass]="isSuccess ? 'alert-success' : 'alert-danger'"
      >
        <strong>{{ notifyTitle }}</strong> {{ notifyContent }}
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
          aria-label="Close"
        ></button>
      </div>
      <div class="d-flex flex-wrap song-active-banner mb-5">
        <div class="song-img-active-container pe-4">
          <img
            *ngIf="song"
            [src]="'http://localhost:8080/symphony/uploads' + song.song_img"
            alt=""
            class="song-img-active rounded-circle"
          />
        </div>
        <div class="song-active-info d-flex flex-column-reverse pt-4">
          <p *ngIf="song" href="" class="text-white-primary">
            <ng-container
              *ngFor="
                let singer of song.singers;
                let i = index;
                let isLast = last
              "
            >
              <a
                class="refer text-decoration-none text-white-primary"
                [routerLink]="['/singer', singer.singer_id]"
              >
                {{ singer.stageName }}
              </a>
              <span *ngIf="!isLast">, </span>
            </ng-container>
          </p>
          <h1 *ngIf="song" class="text-white-primary">{{ song.songName }}</h1>
        </div>
      </div>

      <div class="active-song-option mb-4 d-flex flex-wrap">
        <span *ngIf="song" (click)="toggleSendSong()">
          <div
            class="active-song-status rounded-circle bg-orange-primary me-4 d-flex flex-column justify-content-center"
          >
            <i
              class="fa-solid fa-play d-block mx-auto text-white-primary fs-3"
            ></i>
            <!-- <i class="fa-solid fa-pause d-block mx-auto text-white-primary fs-3"></i> -->
          </div>
        </span>
        <div class="d-flex p-4 ps-0">
          <div
            class="btn rounded-circle bg-dark_grey-color me-3"
            (click)="addSongToPlaylist()"
          >
            <i class="fa-solid fa-plus text-white-primary"></i>
          </div>
          <i
            *ngIf="song"
            class="fa-regular fa-heart btn lh-base refer"
            [ngClass]="
              song.favorite ? 'text-orange-primary' : 'text-white-primary'
            "
            (click)="toggleFavorite()"
          ></i>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-7">
          <div class="song-active-detail-info text-white-primary mb-5">
            <h4 class="mb-4">Thông tin chi tiết</h4>
            <p>
              <strong>Ca sĩ: </strong>
              <ng-container *ngIf="song">
                <ng-container
                  *ngFor="
                    let singer of song.singers;
                    let i = index;
                    let isLast = last
                  "
                >
                  <a
                    class="refer text-decoration-none text-white-primary"
                    [routerLink]="['/singer', singer.singer_id]"
                  >
                    {{ singer.stageName }}
                  </a>
                  <span *ngIf="!isLast">, </span>
                </ng-container>
              </ng-container>
            </p>
            <p>
              <strong>Nhạc sĩ: </strong>
              <span *ngIf="song">{{ this.song.author }}</span>
            </p>
            <p>
              <strong>Thể loại: <img src="" alt="" />: </strong>
              <ng-container *ngIf="song">
                <ng-container
                  *ngFor="
                    let category of song.categories;
                    let i = index;
                    let isLast = last
                  "
                >
                  <a
                    class="px-2 py-1 bg-dark_grey-color rounded text-decoration-none text-white-primary me-2 hashtag_category"
                    [routerLink]="['/search']"
                    [queryParams]="{ s: category.category_name }"
                  >
                    {{ category.category_name }}
                  </a>
                  <span *ngIf="!isLast">, </span>
                </ng-container>
              </ng-container>
            </p>
            <p>
              <strong>Lượt nghe: </strong>
              <span *ngIf="song">{{
                this.song.total_listens | number : "1.0-0"
              }}</span>
            </p>
            <p>
              <strong>Ngày phát hành: </strong>
              <span *ngIf="song">{{
                this.song.releaseDate | date : "dd/MM/yyyy"
              }}</span>
            </p>
          </div>

          <div class="song-active-lyric text-white-primary mb-5">
            <h4 class="mb-4">Lời bài hát</h4>
            <div
              *ngIf="!isLoadingLyric && lyricContent"
              class="lyric-container"
              [class.expanded]="isLyricExpanded"
            >
              <p *ngFor="let line of lyricLines">{{ line }}</p>
            </div>

            <div *ngIf="isLoadingLyric" class="loading">
              Đang tải lời bài hát...
            </div>
            <div
              *ngIf="!isLoadingLyric && !lyricContent && song?.lyric"
              class="lyric-error"
            >
              Không thể tải lời bài hát.
            </div>
            <div *ngIf="!isLoadingLyric && !song?.lyric" class="no-lyric">
              Bài hát này chưa có lời.
            </div>
            <span id="elastic" (click)="toggleLyricExpansion()" class="refer">{{
              getExpandButtonText()
            }}</span>
          </div>
        </div>
        <div class="col-sm-5">
          <h4 class="mb-4 text-white-primary">Có thể bạn muốn nghe</h4>

          <div class="rounded bg-dark_grey-color px-3 py-2">
            <div
              class="d-flex py-2 border-2 border-bottom"
              style="border-color: var(--text_light_theme-color) !important"
            >
              <img
                *ngIf="song"
                [src]="'http://localhost:8080/symphony/uploads' + song.song_img"
                alt=""
                class="rounded"
                style="width: 60px; height: 60px"
              />
              <div class="ms-3 d-flex flex-column">
                <p class="text-white-primary fw-bold pb-0 mb-2">
                  {{ song.songName }}
                </p>
                <div>
                  <ng-container
                    *ngFor="
                      let singer of song.singers;
                      let i = index;
                      let isLast = last
                    "
                  >
                    <a
                      class="refer text-decoration-none text-secondary"
                      [routerLink]="['/singer', singer.singer_id]"
                    >
                      {{ singer.stageName }}
                    </a>
                    <span *ngIf="!isLast">, </span>
                  </ng-container>
                </div>
              </div>
            </div>
          </div>
          <ng-container *ngFor="let song of songRecommend"> </ng-container>
        </div>
      </div>

      <!-- <div class="container song-suggestion mt-4 p-0">
        <div class="d-flex justify-content-between mb-3">
          <h5 class="text-white-primary">CÓ THỂ BẠN MUỐN NGHE</h5>
          <a
            href="/home"
            class="text-decoration-none text-support fw-bolder refer"
            >Tất cả
            <i class="fa-solid fa-chevron-right"></i>
          </a>
        </div>
        <div class="row">
          <app-card
            class="col-12 col-sm-6 col-md-3 col-lg-2 mb-2"
            *ngFor="let song of songRecommend"
            [song]="song"
          >
          </app-card>
        </div>
      </div> -->
    </div>
  </div>
</main>
