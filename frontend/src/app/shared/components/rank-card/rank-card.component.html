<li class="mt-3 p-2 rounded-2 col-md-6 col-lg-12 product-song">
  <div class="row">
    <div class="d-flex flex-column justify-content-center col-lg-1">
      <p class="fs-1 fw-bold m-0" [ngClass]="rank">
        {{ _rank }}
      </p>
    </div>
    <div class="d-flex col-lg-5">
      <div class="product-song_img-container" style="width: 70px">
        <img
          *ngIf="song"
          (click)="toggleSendSong()"
          [src]="'http://localhost:8080/symphony/uploads' + song.song_img"
          class="rounded-2 product-song-img"
          alt=""
          style="width: 55px; height: 55px; cursor: pointer"
        />
      </div>
      <div class="product-song-info d-flex flex-column justify-content-between">
        <h6 class="product-song-name text-white-primary refer mt-2">
          <a
            [routerLink]="['/song', song.song_id]"
            class="refer text-decoration-none text-white-primary"
          >
            {{ song.songName }}
          </a>
        </h6>
        <p class="product-song-singer text-support m-0">
          <ng-container
            *ngFor="
              let singer of song.singers;
              let i = index;
              let isLast = last
            "
          >
            <a
              class="refer text-decoration-none text-support"
              [routerLink]="['/singer', singer.singer_id]"
            >
              {{ singer.stageName }}
            </a>
            <span *ngIf="!isLast">, </span>
          </ng-container>
        </p>
      </div>
    </div>
    <div class="col-lg-3 d-flex flex-column justify-content-center">
      <p class="m-0 refer" *ngIf="song" class="m-0 refer">
        {{ song.songName }}
      </p>
    </div>
    <div class="col-lg-2 d-flex flex-column justify-content-center">
      <p *ngIf="song" class="m-0 ps-2">{{ song.duration | timeFormat }}</p>
    </div>
    <div class="col-5 col-lg-1 d-flex">
      <div class="d-flex flex-column justify-content-center w-50">
        <i
          *ngIf="song"
          class="fa-regular fa-heart fs-6 refer btn favorite-btn"
          [class.text-orange-primary]="favoriteSong()"
          (click)="toggleFavorite()"
        ></i>
      </div>
      <div class="d-flex flex-column justify-content-center w-50">
        <div class="dropdown dropstart text-end">
          <div class="dropdown dropstart text-end">
            <div class="dropdown-toggle text-center" data-bs-toggle="dropdown">
              <i class="fa-solid fa-ellipsis fs-6 refer text-white-primary"></i>
            </div>
            <ul class="dropdown-menu bg-dark_grey-color">
              <li>
                <a
                  class="dropdown-item text-white-primary btn"
                  [routerLink]="['/song', song.song_id]"
                >
                  <i class="fa-solid fa-circle-info pe-2"></i>
                  Chi tiết
                </a>
              </li>
              <li>
                <button
                  class="dropdown-item text-white-primary"
                  data-bs-toggle="modal"
                  data-bs-target="#addToPlaylistModal"
                  (click)="loadUserPlaylists()"
                >
                  <i class="fa-solid fa-plus pe-2"></i>
                  Thêm vào playlist
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</li>

<div
  class="modal fade"
  id="addToPlaylistModal"
  tabindex="-1"
  aria-labelledby="addToPlaylistLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark_grey-color text-white border-0">
      <div class="modal-header">
        <h5 class="modal-title" id="addToPlaylistLabel">Chọn playlist</h5>
        <button
          type="button"
          class="btn-close btn-close-white"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <div *ngIf="userPlaylists.length === 0" class="text-muted">
          Không có playlist nào
        </div>
        <ul class="list-group list-group-flush bg-dark_grey-color">
          <li
            *ngFor="let pl of userPlaylists"
            class="list-group-item list-group-item-action text-white border-0 bg-dark_grey-color"
            style="cursor: pointer"
            (click)="addSongToPlaylist(pl.playlistId)"
            data-bs-dismiss="modal"
          >
            {{ pl.playlistName }}
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
