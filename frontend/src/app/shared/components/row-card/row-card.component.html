<li class="mt-3 p-2 rounded-2 product-song">
    <div class="row">

        <div class="d-flex col-lg-5">
            <div class="product-song_img-container" style="width: 70px;">
                    <img *ngIf="song" (click)="toggleSendSong()" [src]="'http://localhost:8080/symphony/uploads' + song.song_img"
                        class="rounded-2 product-song-img" alt="" style="width: 55px; height: 55px; cursor: pointer;">
            </div>
            <div class="product-song-info d-flex flex-column justify-content-between">
                <h6 class="product-song-name text-white-primary refer mt-2">
                    <a [routerLink]="['/song', song.song_id]" class="refer text-decoration-none text-white-primary">
                        {{ song.songName }}
                    </a>
                </h6>
                <p class="product-song-singer text-support m-0">
                    <ng-container *ngFor="let singer of song.singers; let i = index; let isLast = last">
                        <a class="refer text-decoration-none text-support" [routerLink]="['/singer', singer.singer_id]">
                          {{ singer.stageName }}
                        </a>
                        <span *ngIf="!isLast">, </span>
                    </ng-container>

                </p>
            </div>
        </div>
        <div class="col-lg-4 d-flex flex-column justify-content-center">
            <p *ngIf="song" class="m-0 refer">{{ song.songName }}</p>
        </div>
        <div class="col-lg-2 d-flex flex-column justify-content-center">
            <p *ngIf="song" class="m-0 ps-2">{{ song.duration | timeFormat }}</p>
        </div>
        <div class="col-5 col-lg-1 d-flex">
            <div class="d-flex flex-column justify-content-center w-50 ">
                    <i *ngIf="song" class="fa-regular fa-heart fs-6 refer btn favorite-btn"
                    [class.text-orange-primary]="favoriteSong()"
                    (click)="toggleFavorite()"></i>
            </div>
            <div class="d-flex flex-column justify-content-center w-50">
                <div class="dropdown dropstart text-end">
                    <div class="dropdown dropstart text-end">
                        <div class="dropdown-toggle text-center" data-bs-toggle="dropdown">
                            <i class="fa-solid fa-ellipsis fs-6 refer text-white-primary"></i>
                        </div>
                        <ul class="dropdown-menu bg-dark_grey-color">
                            <li>
                                <a class="dropdown-item text-white-primary btn" [routerLink]="['/song', song.song_id]">
                                    <i class="fa-solid fa-circle-info pe-2"></i>
                                    Chi tiết
                                </a>
                            </li>
                            <li *ngIf="!isLibrary">
                                <button
                                  class="dropdown-item text-white-primary"
                                  data-bs-toggle="modal"
                                  data-bs-target="#addToPlaylistModal"
                                  (click)="openAddToPlaylist(song)"
                                >
                                  <i class="fa-solid fa-plus pe-2"></i>
                                  Thêm vào playlist
                                </button>
                              </li>

                              <li *ngIf="isOwner">
                                <button
                                  class="dropdown-item text-white-primary"
                                  data-bs-toggle="modal"
                                  data-bs-target="#addToAlbumModal"
                                  (click)="openAddToAlbum(song)"
                                >
                                  <i class="fa-solid fa-plus pe-2"></i>
                                  Thêm vào album
                                </button>
                              </li>

                              <li *ngIf="isOwner" (click)="openAddToAlbum(song)">
                                <button
                                  class="dropdown-item text-white-primary"
                                  (click)="deleteSongFromAlbum()"
                                >
                                  <i class="fa-solid fa-plus pe-2"></i>
                                  Xóa khỏi album
                                </button>
                              </li>

                              <li *ngIf="isLibrary">
                                <button
                                  class="dropdown-item text-white-primary"
                                  (click)="onDeleteSongInPlaylist(song)"
                                >
                                <i class="fa-solid fa-circle-info pe-2"></i>
                                Xóa khỏi playlist
                                </button>
                            </li>
                              
                                <li *ngIf="isOwner" (click)="onEdit()" (click)="onSelectSong()">
                                    <span class="dropdown-item text-white-primary btn" data-bs-toggle="modal" data-bs-target="#songModalEdit">
                                        <i class="fa-solid fa-pen-to-square pe-2"></i>
                                        Chỉnh sửa
                                    </span>
                                </li>
                                <li *ngIf="isOwner" (click)="onDelete()" (click)="onSelectSong()">
                                    <span class="dropdown-item text-white-primary btn w-100 d-block p-0">
                                            <span class="delete-song w-100 d-block px-3 py-1" style="cursor: pointer;" data-bs-toggle="modal" data-bs-target="#deleteSongModal">
                                                <i class="fa-solid fa-trash pe-2"></i>
                                                Xóa bài hát
                                            </span>
                                    </span>
                                </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</li>

<div class="modal fade" id="addToPlaylistModal" tabindex="-1" aria-labelledby="addToPlaylistLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark_grey-color text-white-primary border-0">
        <div class="modal-header">
          <h5 class="modal-title text-white-primary" id="addToPlaylistLabel">Chọn playlist</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div *ngIf="userPlaylists.length === 0" class="text-muted text-white-primary">Không có playlist nào</div>
          <ul class="list-group list-group-flush bg-dark_grey-color">
            <li
              *ngFor="let pl of userPlaylists"
              class="list-group-item list-group-item-action border-0 bg-dark_grey-color text-white-primary"
              style="cursor: pointer;"
              (click)="addSongToPlaylist(pl.playlistId)"
              data-bs-dismiss="modal"
            >
              {{ pl.playlistName }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="addToAlbumModal" tabindex="-1" aria-labelledby="addToAlbumLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark_grey-color text-white-primary border-0">
        <div class="modal-header">
          <h5 class="modal-title text-white-primary" id="addToPlaylistLabel">Chọn album</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div *ngIf="singerAlbums.length === 0" class="text-muted text-white-primary">Không có album nào</div>
          <ul class="list-group list-group-flush bg-dark_grey-color">
            <li
              *ngFor="let sa of singerAlbums"
              class="list-group-item list-group-item-action border-0 bg-dark_grey-color text-white-primary"
              style="cursor: pointer;"
              (click)="addSongToAlbum(sa.albumId)"
              data-bs-dismiss="modal"
            >
              {{ sa.albumName }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  
